<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
		PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
		"https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.isix.easyGym.payform.dao.PayformDAO">

	<resultMap type="payformDTO" id="payformResult">
		<result property="payformNo" column="payformNo"/>
		<result property="memberNo" column="memberNo"/>
		<result property="detailNo" column="detailNo"/>
		<result property="payformSub" column="payformSub"/>
		<result property="payformPrice" column="payformPrice"/>
		<result property="payformDate" column="payformDate"/>
		<result property="payformStatus" column="payformStatus"/>
		<result property="payformPayment" column="payformPayment"/>
		<result property="payformCancelDate" column="payformCancelDate"/>
	</resultMap>

	<select id="selectPayform" parameterType="int" resultMap="payformResult">
		SELECT
		p.payformNo, p.memberNo, p.detailNo, p.payformSub, p.payformPrice,
		p.payformDate, p.payformStatus, p.payformPayment, p.payformCancelDate,
		m.memberName, m.memberPhone,
		d.detailBusinessName, d.detailMonthlyTicket
		FROM
		payform_tbl p
		JOIN member_tbl m ON p.memberNo = m.memberNo
		JOIN detail_tbl d ON p.detailNo = d.detailNo
		WHERE
		p.memberNo = #{memberNo}
	</select>

	<insert id="insertPayform" parameterType="com.isix.easyGym.payform.dto.PayformDTO">
		INSERT INTO payform_tbl (
		memberNo, detailNo, payformSub, payformPrice, payformDate,
		payformStatus, payformPayment
		) VALUES (
		#{memberNo}, #{detailNo}, #{payformSub}, #{payformPrice}, NOW(),
		#{payformStatus}, #{payformPayment}
		)
	</insert>

	<delete id="deletePayform" parameterType="int">
		DELETE FROM payform_tbl
		WHERE payformNo = #{payformNo}
	</delete>

	<select id="checkingBuy" parameterType="int" resultType="payformDTO">
		select * from buy_tbl where memberNo = #{memberNo}
	</select>
	
	
</mapper>